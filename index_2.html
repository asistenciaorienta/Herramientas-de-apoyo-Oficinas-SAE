
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Proceso de Orientación - Flechas Dinámicas Corregidas</title>
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      background: #ffffff;
      margin: 0;
      padding: 2rem;
    }

    h1 {
      text-align: center;
      color: #087021;
    }

    .diagram {
      display: grid;
      grid-template-columns: repeat(7, 1fr); /* más columnas = más espacio horizontal */
      grid-template-rows: auto auto auto;
      gap: 2rem;
      justify-items: center;
      align-items: center;
      position: relative;
      max-width: 1000px;
      margin: 0 auto;
     /*  min-height: 600px;*/
    }

    .box {
      padding: 1rem 1.5rem;
      border-radius: 10px;
      color: #ffffff;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      width: 200px;
      position: relative;
      z-index: 1;
    }

    #inicio { background: #087021; grid-column: 1; grid-row: 2; }
    #puntuales { background: #e3cd66; color:#333; grid-column: 3; grid-row: 1; }
    #profundidad { background: #a5cca0; color:#333; grid-column: 3; grid-row: 3; }
    #itinerario { background: #77b5c3; grid-column: 5; grid-row: 2; }
    #servicios { background: #087021; grid-column: 7; grid-row: 2; }

    svg.arrows {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 0;
    }

    path {
      stroke: #333;
      stroke-width: 2;
      fill: none;
     /*  marker-end: url(#arrowhead);*/
    }
  </style>
</head>
<body>
  <h1>Proceso de Orientación</h1>
  <div class="diagram" id="diagram">
    <div class="box" id="inicio">Entrevista Inicial <br> de Orientación</div>
    <div class="box" id="puntuales">Servicios <br> Puntuales</div>
    <div class="box" id="profundidad">Entrevista <br>en Profundidad</div>
    <div class="box" id="itinerario">Diseño de <br> Itinerario</div>
    <div class="box" id="servicios">Desarrollo de <br> Servicios</div>

    <svg class="arrows">
      <defs>
        <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="12" refY="4" orient="auto" markerUnits="strokeWidth">
          <polygon points="0 0, 12 4, 0 8" fill="#333" />
        </marker>
      </defs>
    </svg>
  </div>

  <script>
    function getBlockPosition(block) {
      return {
        left: block.offsetLeft,
        top: block.offsetTop,
        width: block.offsetWidth,
        height: block.offsetHeight,
        right: block.offsetLeft + block.offsetWidth,
        bottom: block.offsetTop + block.offsetHeight
      };
    }


    function drawArrow(svg, fromBlock, toBlock) {
      const container = svg.parentElement;
      const from = getBlockPosition(fromBlock, container);
      const to = getBlockPosition(toBlock, container);

      // Salida desde el borde derecho del bloque de origen
      const x1 = from.right;
      const y1 = from.top + from.height/2;

      // Entrada al borde izquierdo del bloque destino
      const x2 = to.left;
      const y2 = to.top + to.height/2;

      // Control points para curva suave
//       const cx1 = x1 + (x2 - x1)/2;
//       const cy1 = y1;
//       const cx2 = x1 + (x2 - x1)/2;
//      const cy2 = y2;

const cx1 = x1;
const cy1 = y1 + (y2-y1)/2;
const cx2 = x2;
const cy2 = y1 + (y2-y1)/2;

      

      const path = document.createElementNS("http://www.w3.org/2000/svg","path");
      path.setAttribute("d", `M ${x1} ${y1} C ${cx1} ${cy1}, ${cx2} ${cy2}, ${x2} ${y2}`);
      path.setAttribute("stroke", "#333");
      path.setAttribute("stroke-width", "2");
      path.setAttribute("fill", "none");
      // path.setAttribute("marker-end", "url(#arrowhead)");
      svg.appendChild(path);
    }

    function drawAllArrows() {
      const svg = document.querySelector("svg.arrows");
      const container = document.getElementById("diagram");

      // Limpiar las flechas existentes
      svg.innerHTML = `<defs>
        <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
          <polygon points="0 0, 12 4, 0 8" fill="#333" />
        </marker>
      </defs>`;

      svg.setAttribute("width", container.offsetWidth);
      svg.setAttribute("height", container.offsetHeight);
      svg.setAttribute("viewBox", `0 0 ${container.offsetWidth} ${container.offsetHeight}`);
      drawArrow(svg, document.getElementById("inicio"), document.getElementById("puntuales"));
      drawArrow(svg, document.getElementById("inicio"), document.getElementById("itinerario"));
      drawArrow(svg, document.getElementById("inicio"), document.getElementById("profundidad"));
      drawArrow(svg, document.getElementById("puntuales"), document.getElementById("itinerario"));
      drawArrow(svg, document.getElementById("profundidad"), document.getElementById("itinerario"));
      drawArrow(svg, document.getElementById("itinerario"), document.getElementById("servicios"));
    }

    window.addEventListener("load", drawAllArrows);
    window.addEventListener("resize", drawAllArrows);
  </script>
</body>
</html>
