<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Proceso de Orientación - Prototipo SAE Dinámico</title>
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      background: #ffffff;
      margin: 0;
      padding: 2rem;
    }

    h1 {
      text-align: center;
      color: #087021;
    }

    .diagram {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      grid-template-rows: auto auto auto;
      gap: 2rem;
      justify-items: center;
      align-items: center;
      position: relative;
      max-width: 1000px;
      margin: 0 auto;
    }

    .box {
      padding: 1rem 1.5rem;
      border-radius: 10px;
      color: #ffffff;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      width: 200px;
      position: relative;
      z-index: 1;
    }

    #inicio { background: #087021; grid-column: 1; grid-row: 2; }
    #puntuales { background: #e3cd66; color:#333; grid-column: 2; grid-row: 1; }
    #profundidad { background: #a5cca0; color:#333; grid-column: 2; grid-row: 3; }
    #itinerario { background: #77b5c3; grid-column: 2; grid-row: 2; }
    #servicios { background: #087021; grid-column: 3; grid-row: 2; }

    svg.arrows {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 2;
    }

    path {
      stroke: #333;
      stroke-width: 2;
      fill: none;
      marker-end: url(#arrowhead);
    }
  </style>
</head>
<body>
  <h1>Proceso de Orientación</h1>
  <div class="diagram">
    <div class="box" id="inicio">Entrevista Inicial</div>
    <div class="box" id="puntuales">Servicios Puntuales</div>
    <div class="box" id="profundidad">Entrevista Profundidad</div>
    <div class="box" id="itinerario">Diseño de Itinerario</div>
    <div class="box" id="servicios">Desarrollo de Servicios</div>

    <svg class="arrows" viewBox="0 0 1000 600" preserveAspectRatio="none">
      <defs>
        <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
          <polygon points="0 0, 12 4, 0 8" fill="#333" />
        </marker>
      </defs>
    </svg>
  </div>

  <script>
    function getCenter(el) {
      const rect = el.getBoundingClientRect();
      const parentRect = el.parentElement.getBoundingClientRect();
      return {
        x: rect.left + rect.width/2 - parentRect.left,
        y: rect.top + rect.height/2 - parentRect.top,
        left: rect.left - parentRect.left,
        right: rect.right - parentRect.left,
        top: rect.top - parentRect.top,
        bottom: rect.bottom - parentRect.top,
        width: rect.width,
        height: rect.height
      };
    }

    function drawArrow(svg, startEl, endEl, offsetStartX=0, offsetStartY=0, offsetEndX=0, offsetEndY=0) {
      const start = getCenter(startEl);
      const end = getCenter(endEl);

      // Salida desde borde derecho/izquierdo
      const x1 = start.right + offsetStartX;
      const y1 = start.top + start.height/2 + offsetStartY;

      const x2 = end.left + offsetEndX;
      const y2 = end.top + end.height/2 + offsetEndY;

      // Control points para curva suave
      const cx1 = x1 + (x2-x1)/2;
      const cy1 = y1;
      const cx2 = x1 + (x2-x1)/2;
      const cy2 = y2;

      const path = document.createElementNS("http://www.w3.org/2000/svg","path");
      path.setAttribute("d", `M ${x1} ${y1} C ${cx1} ${cy1}, ${cx2} ${cy2}, ${x2} ${y2}`);
      path.setAttribute("stroke", "#333");
      path.setAttribute("stroke-width", "2");
      path.setAttribute("fill", "none");
      path.setAttribute("marker-end", "url(#arrowhead)");
      svg.appendChild(path);
    }

    function drawAllArrows() {
      const svg = document.querySelector("svg.arrows");
      svg.innerHTML = `<defs>
        <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
          <polygon points="0 0, 12 4, 0 8" fill="#333" />
        </marker>
      </defs>`;

      drawArrow(svg, document.getElementById("inicio"), document.getElementById("puntuales"));
      drawArrow(svg, document.getElementById("inicio"), document.getElementById("itinerario"));
      drawArrow(svg, document.getElementById("inicio"), document.getElementById("profundidad"));
      drawArrow(svg, document.getElementById("puntuales"), document.getElementById("itinerario"));
      drawArrow(svg, document.getElementById("profundidad"), document.getElementById("itinerario"));
      drawArrow(svg, document.getElementById("itinerario"), document.getElementById("servicios"));
    }

    window.addEventListener("load", drawAllArrows);
    window.addEventListener("resize", drawAllArrows); // Recalcula si se cambia tamaño
  </script>
</body>
</html>
